---
- hosts: all
  roles:
    - role_under_test

  post_tasks:
    - name: Install keystone package (Debian)
      apt:
        name: keystone
        state: present
      when: ansible_os_family == 'Debian'

    - name: Install keystone package (RedHat)
      yum:
        name: openstack-keystone
        state: present
      when: ansible_os_family == 'RedHat'

    - name: Install keystone package (Suse)
      command: zypper --gpg-auto-import-keys --non-interactive install openstack-keystone
      args:
       creates: /etc/keystone/keystone.conf
      when: ansible_os_family == 'Suse'
